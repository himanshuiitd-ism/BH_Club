import React, { useState, useRef, useEffect } from "react";

const EmojiSelector = ({
  onEmojiSelect,
  isOwnMessage,
  onClose,
  position = "bottom",
}) => {
  const [selectedCategory, setSelectedCategory] = useState("smileys");
  const selectorRef = useRef(null);

  const emojiCategories = {
    smileys: {
      name: "ðŸ˜Š Smileys",
      emojis: [
        "ðŸ˜€",
        "ðŸ˜ƒ",
        "ðŸ˜„",
        "ðŸ˜",
        "ðŸ˜†",
        "ðŸ˜…",
        "ðŸ¤£",
        "ðŸ˜‚",
        "ðŸ™‚",
        "ðŸ™ƒ",
        "ðŸ˜‰",
        "ðŸ˜Š",
        "ðŸ˜‡",
        "ðŸ¥°",
        "ðŸ˜",
        "ðŸ¤©",
        "ðŸ˜˜",
        "ðŸ˜—",
        "ðŸ˜š",
        "ðŸ˜™",
        "ðŸ˜‹",
        "ðŸ˜›",
        "ðŸ˜œ",
        "ðŸ¤ª",
        "ðŸ˜",
        "ðŸ¤‘",
        "ðŸ¤—",
        "ðŸ¤­",
        "ðŸ¤«",
        "ðŸ¤”",
        "ðŸ¤",
        "ðŸ¤¨",
        "ðŸ˜",
        "ðŸ˜‘",
        "ðŸ˜¶",
        "ðŸ˜",
        "ðŸ˜’",
        "ðŸ™„",
        "ðŸ˜¬",
        "ðŸ¤¥",
        "ðŸ˜”",
        "ðŸ˜ª",
        "ðŸ¤¤",
        "ðŸ˜´",
        "ðŸ˜·",
        "ðŸ¤’",
        "ðŸ¤•",
        "ðŸ¤¢",
        "ðŸ¤®",
        "ðŸ¤§",
        "ðŸ¥µ",
        "ðŸ¥¶",
        "ðŸ¥´",
        "ðŸ˜µ",
        "ðŸ¤¯",
        "ðŸ¤ ",
        "ðŸ¥³",
        "ðŸ˜Ž",
        "â˜ ï¸",
        "ðŸ’€",
      ],
    },
    gestures: {
      name: "ðŸ‘ Gestures",
      emojis: [
        "ðŸ‘",
        "ðŸ‘Ž",
        "ðŸ‘Œ",
        "ðŸ¤",
        "âœŒï¸",
        "ðŸ¤ž",
        "ðŸ¤Ÿ",
        "ðŸ¤˜",
        "ðŸ¤™",
        "ðŸ‘ˆ",
        "ðŸ‘‰",
        "ðŸ‘†",
        "ðŸ–•",
        "ðŸ‘‡",
        "â˜ï¸",
        "ðŸ‘",
        "ðŸ™Œ",
        "ðŸ‘",
        "ðŸ¤²",
        "ðŸ¤",
        "ðŸ™",
        "âœï¸",
        "ðŸ’ª",
        "ðŸ¦¾",
        "ðŸ¦µ",
        "ðŸ¦¿",
        "ðŸ’„",
        "ðŸ’‹",
        "ðŸ‘„",
        "ðŸ¦·",
        "ðŸ‘…",
        "ðŸ‘‚",
        "ðŸ¦»",
        "ðŸ‘ƒ",
        "ðŸ‘£",
        "ðŸ‘ï¸",
        "ðŸ‘€",
        "ðŸ§ ",
        "ðŸ«€",
        "ðŸ«",
        "ðŸ©¸",
        "ðŸ‘¶",
        "ðŸ§’",
        "ðŸ‘¦",
        "ðŸ‘§",
        "ðŸ§‘",
        "ðŸ‘±",
        "ðŸ‘¨",
        "ðŸ§”",
        "ðŸ‘¨â€ðŸ¦°",
        "ðŸ‘¨â€ðŸ¦±",
        "ðŸ‘¨â€ðŸ¦³",
        "ðŸ‘¨â€ðŸ¦²",
        "ðŸ‘©",
        "ðŸ‘©â€ðŸ¦°",
        "ðŸ‘©â€ðŸ¦±",
        "ðŸ‘©â€ðŸ¦³",
        "ðŸ‘©â€ðŸ¦²",
      ],
    },
    hearts: {
      name: "â¤ï¸ Hearts",
      emojis: [
        "â¤ï¸",
        "ðŸ§¡",
        "ðŸ’›",
        "ðŸ’š",
        "ðŸ’™",
        "ðŸ’œ",
        "ðŸ–¤",
        "ðŸ¤",
        "ðŸ¤Ž",
        "ðŸ’”",
        "â£ï¸",
        "ðŸ’•",
        "ðŸ’ž",
        "ðŸ’“",
        "ðŸ’—",
        "ðŸ’–",
        "ðŸ’˜",
        "ðŸ’",
        "ðŸ’Ÿ",
        "â™¥ï¸",
        "ðŸ’¯",
        "ðŸ’¢",
        "ðŸ’¥",
        "ðŸ’«",
        "ðŸ’¦",
        "ðŸ’¨",
        "ðŸ•³ï¸",
        "ðŸ’£",
        "ðŸ’¬",
        "ðŸ‘ï¸â€ðŸ—¨ï¸",
        "ðŸ—¨ï¸",
        "ðŸ—¯ï¸",
        "ðŸ’­",
        "ðŸ’¤",
      ],
    },
    animals: {
      name: "ðŸ¶ Animals",
      emojis: [
        "ðŸ¶",
        "ðŸ±",
        "ðŸ­",
        "ðŸ¹",
        "ðŸ°",
        "ðŸ¦Š",
        "ðŸ»",
        "ðŸ¼",
        "ðŸ¨",
        "ðŸ¯",
        "ðŸ¦",
        "ðŸ®",
        "ðŸ·",
        "ðŸ½",
        "ðŸ¸",
        "ðŸµ",
        "ðŸ™ˆ",
        "ðŸ™‰",
        "ðŸ™Š",
        "ðŸ’",
        "ðŸ”",
        "ðŸ§",
        "ðŸ¦",
        "ðŸ¤",
        "ðŸ£",
        "ðŸ¥",
        "ðŸ¦†",
        "ðŸ¦…",
        "ðŸ¦‰",
        "ðŸ¦‡",
        "ðŸº",
        "ðŸ—",
        "ðŸ´",
        "ðŸ¦„",
        "ðŸ",
        "ðŸ›",
        "ðŸ¦‹",
        "ðŸŒ",
        "ðŸž",
        "ðŸœ",
        "ðŸ¦Ÿ",
        "ðŸ¦—",
        "ðŸ•·ï¸",
        "ðŸ•¸ï¸",
        "ðŸ¦‚",
        "ðŸ¢",
        "ðŸ",
        "ðŸ¦Ž",
        "ðŸ¦–",
        "ðŸ¦•",
        "ðŸ™",
        "ðŸ¦‘",
        "ðŸ¦",
        "ðŸ¦ž",
        "ðŸ¦€",
        "ðŸ¡",
        "ðŸ ",
        "ðŸŸ",
        "ðŸ¬",
        "ðŸ³",
        "ðŸ‹",
        "ðŸ¦ˆ",
        "ðŸŠ",
        "ðŸ…",
        "ðŸ†",
        "ðŸ¦“",
        "ðŸ¦",
        "ðŸ¦§",
        "ðŸ˜",
        "ðŸ¦›",
        "ðŸ¦",
        "ðŸª",
        "ðŸ«",
        "ðŸ¦’",
        "ðŸ¦˜",
        "ðŸƒ",
        "ðŸ‚",
        "ðŸ„",
        "ðŸŽ",
        "ðŸ–",
        "ðŸ",
        "ðŸ‘",
        "ðŸ¦™",
        "ðŸ",
        "ðŸ¦Œ",
        "ðŸ•",
        "ðŸ©",
        "ðŸ¦®",
        "ðŸ•â€ðŸ¦º",
        "ðŸˆ",
        "ðŸˆâ€â¬›",
        "ðŸ“",
        "ðŸ¦ƒ",
        "ðŸ¦š",
        "ðŸ¦œ",
        "ðŸ¦¢",
        "ðŸ¦©",
        "ðŸ•Šï¸",
        "ðŸ‡",
        "ðŸ¦",
        "ðŸ¦¨",
        "ðŸ¦¡",
        "ðŸ¦¦",
        "ðŸ¦¥",
        "ðŸ",
        "ðŸ€",
        "ðŸ¿ï¸",
      ],
    },
    food: {
      name: "ðŸ• Food",
      emojis: [
        "ðŸŽ",
        "ðŸ",
        "ðŸŠ",
        "ðŸ‹",
        "ðŸŒ",
        "ðŸ‰",
        "ðŸ‡",
        "ðŸ“",
        "ðŸ«",
        "ðŸˆ",
        "ðŸ’",
        "ðŸ‘",
        "ðŸ¥­",
        "ðŸ",
        "ðŸ¥¥",
        "ðŸ¥",
        "ðŸ…",
        "ðŸ†",
        "ðŸ¥‘",
        "ðŸ¥¦",
        "ðŸ¥¬",
        "ðŸ¥’",
        "ðŸŒ¶ï¸",
        "ðŸ«‘",
        "ðŸŒ½",
        "ðŸ¥•",
        "ðŸ«’",
        "ðŸ§„",
        "ðŸ§…",
        "ðŸ¥”",
        "ðŸ ",
        "ðŸ¥",
        "ðŸ¥¯",
        "ðŸž",
        "ðŸ¥–",
        "ðŸ¥¨",
        "ðŸ§€",
        "ðŸ¥š",
        "ðŸ³",
        "ðŸ§ˆ",
        "ðŸ¥ž",
        "ðŸ§‡",
        "ðŸ¥“",
        "ðŸ¥©",
        "ðŸ—",
        "ðŸ–",
        "ðŸ¦´",
        "ðŸŒ­",
        "ðŸ”",
        "ðŸŸ",
        "ðŸ•",
        "ðŸ«“",
        "ðŸ¥ª",
        "ðŸ¥™",
        "ðŸ§†",
        "ðŸŒ®",
        "ðŸŒ¯",
        "ðŸ«”",
        "ðŸ¥—",
        "ðŸ¥˜",
        "ðŸ«•",
        "ðŸ",
        "ðŸœ",
        "ðŸ²",
        "ðŸ›",
        "ðŸ£",
        "ðŸ±",
        "ðŸ¥Ÿ",
        "ðŸ¦ª",
        "ðŸ¤",
        "ðŸ™",
        "ðŸš",
        "ðŸ˜",
        "ðŸ¥",
        "ðŸ¥ ",
        "ðŸ¥®",
        "ðŸ¢",
        "ðŸ¡",
        "ðŸ§",
        "ðŸ¨",
        "ðŸ¦",
        "ðŸ¥§",
        "ðŸ§",
        "ðŸ°",
        "ðŸŽ‚",
        "ðŸ®",
        "ðŸ­",
        "ðŸ¬",
        "ðŸ«",
        "ðŸ¿",
        "ðŸ©",
        "ðŸª",
        "ðŸŒ°",
        "ðŸ¥œ",
        "ðŸ¯",
      ],
    },
    activities: {
      name: "âš½ Activities",
      emojis: [
        "âš½",
        "ðŸ€",
        "ðŸˆ",
        "âš¾",
        "ðŸ¥Ž",
        "ðŸŽ¾",
        "ðŸ",
        "ðŸ‰",
        "ðŸ¥",
        "ðŸŽ±",
        "ðŸª€",
        "ðŸ“",
        "ðŸ¸",
        "ðŸ’",
        "ðŸ‘",
        "ðŸ¥",
        "ðŸ",
        "ðŸªƒ",
        "ðŸ¥…",
        "â›³",
        "ðŸª",
        "ðŸ¹",
        "ðŸŽ£",
        "ðŸ¤¿",
        "ðŸ¥½",
        "ðŸ¥¼",
        "ðŸ¦º",
        "â›·ï¸",
        "ðŸ‚",
        "ðŸ„",
        "ðŸ„â€â™‚ï¸",
        "ðŸ„â€â™€ï¸",
        "ðŸš£",
        "ðŸš£â€â™‚ï¸",
        "ðŸš£â€â™€ï¸",
        "ðŸŠ",
        "ðŸŠâ€â™‚ï¸",
        "ðŸŠâ€â™€ï¸",
        "â›¹ï¸",
        "â›¹ï¸â€â™‚ï¸",
        "â›¹ï¸â€â™€ï¸",
        "ðŸ‹ï¸",
        "ðŸ‹ï¸â€â™‚ï¸",
        "ðŸ‹ï¸â€â™€ï¸",
        "ðŸš´",
        "ðŸš´â€â™‚ï¸",
        "ðŸš´â€â™€ï¸",
        "ðŸšµ",
        "ðŸšµâ€â™‚ï¸",
        "ðŸšµâ€â™€ï¸",
        "ðŸ¤¸",
        "ðŸ¤¸â€â™‚ï¸",
        "ðŸ¤¸â€â™€ï¸",
        "ðŸ¤¼",
        "ðŸ¤¼â€â™‚ï¸",
        "ðŸ¤¼â€â™€ï¸",
        "ðŸ¤½",
        "ðŸ¤½â€â™‚ï¸",
        "ðŸ¤½â€â™€ï¸",
        "ðŸ¤¾",
        "ðŸ¤¾â€â™‚ï¸",
        "ðŸ¤¾â€â™€ï¸",
        "ðŸ¤¹",
        "ðŸ¤¹â€â™‚ï¸",
        "ðŸ¤¹â€â™€ï¸",
        "ðŸ§˜",
        "ðŸ§˜â€â™‚ï¸",
        "ðŸ§˜â€â™€ï¸",
        "ðŸ›€",
        "ðŸ›Œ",
      ],
    },
  };

  useEffect(() => {
    const handleClickOutside = (event) => {
      if (selectorRef.current && !selectorRef.current.contains(event.target)) {
        onClose();
      }
    };

    document.addEventListener("mousedown", handleClickOutside);
    return () => document.removeEventListener("mousedown", handleClickOutside);
  }, [onClose]);

  const handleEmojiClick = (emoji) => {
    onEmojiSelect(emoji);
    onClose();
  };

  return (
    <div
      className={`emoji-selector ${position} ${
        isOwnMessage ? "ownEmojiSelector" : "otherEmojiSelector"
      }`}
      ref={selectorRef}
    >
      <div className="emoji-selector-header">
        <h4>Choose a reaction</h4>
        <button className="close-btn" onClick={onClose}>
          Ã—
        </button>
      </div>

      <div className="emoji-categories">
        {Object.entries(emojiCategories).map(([key, category]) => (
          <button
            key={key}
            className={`category-btn ${
              selectedCategory === key ? "active" : ""
            }`}
            onClick={() => setSelectedCategory(key)}
          >
            {category.name.split(" ")[0]}
          </button>
        ))}
      </div>

      <div className="emoji-grid">
        {emojiCategories[selectedCategory].emojis.map((emoji, index) => (
          <button
            key={index}
            className="emoji-btn"
            onClick={() => handleEmojiClick(emoji)}
          >
            {emoji}
          </button>
        ))}
      </div>
    </div>
  );
};

export default EmojiSelector;
